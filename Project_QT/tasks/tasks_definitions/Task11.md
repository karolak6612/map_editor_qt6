**Task11: Implement `Map` Data Structure in Qt (Core Logic, Tile/Item/Creature Storage, Iterators)**
-   Task: **Implement the `Map` class in `Project_QT` using appropriate and efficient Qt data structures (e.g., `QVector` for layers, `QMap` or multi-dimensional `QVector` for tiles, as further detailed in `Task11.md`).**
    -   **Analyze Existing Code:** Thoroughly analyze any existing `Map` class structure or related data management code within `Project_QT/src`. The new implementation must integrate with, refactor, or replace this existing code to meet the full requirements.
    -   **Core Data Preservation:** Ensure the `Map` class can store and manage all core data elements from the `wxwidgets` version, including:
        -   Map dimensions (width, height, floors).
        -   Tiles: The primary container for `Tile` objects.
        -   Layers: If the original map had a distinct concept of layers separate from tile Z-levels.
        -   Conceptual Zones, Spawns, Houses, Waypoints: The `Map` should provide mechanisms or containers (stubs for now if full classes are not yet implemented) for storing references or IDs related to these map-wide entities.
    -   **Thread Safety Considerations:** While full threaded implementation may be later, design core data structures with thread safety in mind if the original application had or the target design implies concurrent access (e.g., using Qt's implicitly shared classes where appropriate, or noting areas needing explicit synchronization).
    -   **`QGraphicsView` Interaction Design:** The `Map` class should be re-designed for optimal interaction with a future `QGraphicsView`-based rendering system. This influences how data is stored and accessed, particularly for:
        -   Model Storage: Efficiently storing map dimensions and `Tile` properties.
        -   Data Retrieval for Rendering: Enabling quick retrieval of visible items per tile and data needed for Z-ordering logic within each `Tile`.
    -   **`Tile` Content:** Crucially, ensure `Tile` objects (from Task 12) managed by the `Map` can dynamically hold collections of items and creatures (e.g., `QVector<Item*>` and `QVector<Creature*>`, as defined in `Task11.md` and further detailed in Task 12 for the `Tile` class itself). This will require logic for sorting/iterating and displaying only relevant types from these collections later.
    -   **Essential Methods (Initial Implementation):** Focus on migrating or implementing the essential structure for efficient storage and data handling related to tile arrangement in maps and core operations needed to work with tile classes:
        -   `getTile(int x, int y, int z)`: Retrieve a `Tile` object.
        -   `setTile(int x, int y, int z, Tile* tile)`: Place a `Tile` object.
        -   `addItem(Tile* tile, Item* item)` / `removeItem(Tile* tile, Item* item)`: Placeholder stubs (full logic in `Tile` or command classes).
        -   `setTileSize(int width, int height)`: If tile pixel size is map-wide.
        -   Generic map loading/saving stubs (e.g., `load(const QString& path)`, `save(const QString& path)`).
    -   **Deferred Functionality:** `setSelection()` for map-wide selections and item transformations (`rotateSelection`, `flipSelection`) are deferred and will be migrated later via specific `Command` classes.
    -   **Iterator Performance:** Refactor any tile or item iterators within the `Map` class (if the intent from `wxwidgets` was high performance) to return raw `Item*` pointers if applicable, so `MapDrawer` and rendering logic within `QGraphicsItems` doesn't constantly call slow object creation or property lookup operations for performance-critical loops.
    -   **Compatibility Note:** The original `wxwidgets::map.cpp/h` already has `Tile` item vectors; ensure the Qt version uses vectors of pointers (`QVector<Item*>`, `QVector<Creature*>`) if this was for speed or reference semantics in the original.
    -   **`Task11.md` contains critical details on the expected internal data structures (e.g., for tile storage, layer management) and specific method signatures for this core `Map` functionality.**
