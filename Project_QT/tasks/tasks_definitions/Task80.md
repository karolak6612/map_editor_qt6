**Task80: Port `Map Display` functions (Zoom, Grid, Mouse Hover/Capture Effects, Full `MapCanvas` Logic)**
- Task: **This task refers to fully implementing all `MapCanvas` (or `MapView` in `project_qt`) drawing and display event functionalities previously handled by `wxWidget` map/tile related functions. This includes smooth Zoom, dynamic Grid Line Drawing, mouse tracking/hover effects, mouse capture behavior, and ensuring any specific UI markers or displays driven by `MapView` state are ported, using Qt types and `QGraphicsItem`s.**
    - **Analyze Existing `MapView`:** Build upon the current `MapView` in `Project_QT/src`, ensuring all its rendering and event handling aligns with Qt idioms.
    - **Zoom Functionality:**
        -   Implement smooth, configurable zoom levels for `MapView` (likely by scaling the `QGraphicsView`'s transformation matrix).
        -   Ensure zoom settings from `DrawingOptions` (or `MapView` properties) are applied correctly.
        -   Zoom operations should trigger updates of visual markers or overall map display for the changed tile rectangle, ideally having `QGraphicsItem`s update their `boundingRect` or LOD if necessary rather than full scene redraws if possible.
    - **Grid Line Drawing (`GridLineDraw`):**
        -   Implement dynamic grid line drawing on `MapView`. The grid should be toggleable and its appearance (color, line style) configurable.
        -   Grid lines should adjust density or visibility based on the current zoom level. This can be done in `MapView::drawBackground()` or `drawForeground()`.
    - **Mouse Tracking & Hover Effects:**
        -   **Cursor Display:** `MapView` should display the current map coordinates under the mouse cursor (e.g., in `StatusBar` via signals to `MainWindow`).
        -   **Brush/Tool Cursor:** The mouse cursor appearance should change based on the active `Brush` or tool (this might be handled by `QApplication::setOverrideCursor` or by `MapView::viewport()->setCursor()`).
        -   **Tile/Item Hover Highlight:** Implement highlighting of `MapTileItem`s or individual `Item` graphics when the mouse hovers over them (using `QGraphicsItem::hoverEnterEvent/hoverLeaveEvent` or `MapView` tracking mouse moves and drawing overlays). This requires `MapTileItem` or individual item graphics to correctly report their shapes for hover detection. These states likely tie into `TileItem`/`DrawingOptions` now.
    - **Mouse Capture Behavior (`onGain/loseMouse`):**
        -   Port logic related to `MapView` gaining or losing mouse capture if this affected state (e.g., `MapPopupMenu` state updates, brush event state machine transitions like for doodad dragging from selection events if `onGainMouse` set paste flags).
        -   Qt widgets handle mouse capture somewhat differently (`QWidget::grabMouse()`, `releaseMouse()`). Adapt original logic to Qt's model.
    - **Item Selection & Interaction (`MouseClick`/`DoubleClick`):**
        -   Finalize how mouse clicks/double-clicks on `MapTileItem`s or specific items interact with the current `Brush`/Tool or selection state. For example, double-clicking an item might open its properties editor (if `doubleclick-properties` setting from `qt::settingsmanager` is enabled).
        -   Ensure `MapCanvas` `event->Skip()` logic (if `wxwidgets` used it to pass events up) is correctly handled by Qt's event propagation.
    - **UI Markers/Displays:** If `MapCanvas` had additional UI markers or displays (e.g., for special tool states, current operation feedback) beyond standard item rendering, port these using `QPainter` in `MapView` overlays or as dedicated `QGraphicsItem`s.
    - **Tooltip with Brush Info:** If the original displayed tooltips showing information about the current brush when hovering over the map, port this using `QToolTip` or custom tooltip handling in `MapView`.
    - **`Task80.md` is key. It must outline all specific drawing routines from `MapCanvas` (grid, hover effects, custom cursors), the logic of `onGain/loseMouse`, how mouse interactions (clicks, double-clicks) were dispatched based on current tool/item, and any custom UI overlays or state displays that `MapCanvas` was responsible for.**

---
