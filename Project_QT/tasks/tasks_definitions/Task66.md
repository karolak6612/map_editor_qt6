**Task66: Migrate House and Town Handling (Data Structures, XML I/O, Basic `Map` Integration & Drawing Hooks)**
- Task: **Migrate core `House` and `Town` data structures (from `wxwidgets house.h/.cpp`, `town.h/.cpp`) to `project_qt` using appropriate Qt data structures. Implement XML serialization/deserialization for houses and towns. Ensure basic interaction with the `Map` class for tile linking and that hooks exist for updating `Tile` and map markers, preparing for UI interaction and full system integration.**
    - **Analyze Existing House/Town Code:** Review `Project_QT/src` for any `House` or `Town` data models or I/O, and integrate/refactor.
    - **`House` and `Town` Data Structures (Qt):**
        -   Create Qt-based classes for `House` and `Town`, replicating all data members from the `wxwidgets` versions (e.g., `House`: ID, name, owner, size, rent, entry tile coords, tile list; `Town`: ID, name, temple position). Use `QString`, `QPoint`, `QList`, etc.
    - **XML Serialization (using `QXmlStreamReader/Writer`):**
        -   Implement loading (`loadHousesFromXML`, `loadTownsFromXML`) and saving (`saveHousesToXML`, `saveTownsToXML`) for `House` and `Town` data from/to their respective XML files (as per original file formats or structure defined in `Task66.md`). Ensure all attributes, including house tile lists and entry points, are persisted.
    - **`Map` Integration:**
        -   `Map` class should now be able to store and manage lists of `House` and `Town` objects (e.g., `QList<House*> m_houses; QList<Town*> m_towns;`).
        -   Implement methods in `Map` like `addHouse(House* h)`, `getHouse(uint32_t houseId)`, `getHouses()`, etc.
        -   Establish how `Tile`s are linked to `House`s (e.g., `Tile::setHouseID(uint32_t id)`, `Map` maintaining a list of tiles per house, or `House` storing its `QList<Tile*>`).
    - **Tile and Map Marker Updates (Conceptual Hooks):**
        -   When a house is modified (e.g., entry set, tiles added/removed from it via `HouseBrush` or editor), associated `Tile` objects must have their `HouseID` (or other relevant flags like `isHouseTile`) updated.
        -   `Map` should emit signals (e.g., `houseDataChanged(House* h)`) when house data is modified, so `MapView` can update visual markers for house areas or entry points (visual markers are Task 58).
        -   If original `Map` had methods like `setHouse()` or `removeHouseExit()` that updated tile state, ensure placeholders for this logic.
    - **Drawing Logic for `HouseBrush` (Placeholders):** The `HouseBrush` (Task 56) will interact with this system. If its selection or placement modified `wxItems` or selection borders directly on `map_display` without explicit `map::tiles` changes, port this concept to ensure `MapView` (or `QGraphicsItems`) correctly reflect house ownership/boundaries when house data changes.
    - **Integration with Item Properties:** If certain `Item`s on a tile designate it as part of a house or an exit (e.g., via `Item` attributes), ensure the house system can query/use this. The goal is to manage house state either through `Tile` properties (like `HouseID`) or via specific `Item`s placed by `HouseBrush`, consistently.
    - **Scope:** Focus is on the data models, XML I/O, and core `Map` linking. Full UI for editing houses (e.g., `showEditHouses`, `select_house` actions) is Task 86/94. This task ensures the data backend is ready.
    - **`Task66.md` must provide the full structures of `House` and `Town` from `wxwidgets`, the exact XML format used for saving/loading them, how house tile lists were managed, and how tile-to-house linking was implemented (e.g., was it just a `HouseID` on the `Tile`, or did `House` own a list of `Tile` pointers/coords?).**
