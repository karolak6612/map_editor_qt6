**Task69: Integrate `Selection` Transformation Commands (Move, Rotate, Flip - Full Undoable Command Structure)**
- Task: **Implement the core commands for transforming the current map selection: Move, Rotate (e.g., 90 degrees clockwise/counter-clockwise), and Flip (horizontal/vertical). These operations must be undoable actions, correctly modifying the `Map` data and triggering visual updates.**
    - **Analyze Existing Transformation/Command Code:** Review `Project_QT/src` for any selection manipulation or undo/redo command patterns.
    - **Command Class Structure (e.g., `QUndoCommand`):**
        -   Create base `SelectionTransformationCommand` inheriting from `QUndoCommand` (or a custom command base).
        -   Subclass for specific transformations: `MoveSelectionCommand`, `RotateSelectionCommand`, `FlipSelectionCommand`.
        -   Each command will store necessary data for its `undo()` and `redo()` methods (e.g., original tile data/item lists for the selection, transformation parameters).
    - **Command Logic:**
        -   **`redo()` (and initial execution):**
            -   Iterate through the `Tile`s/`Item`s in the current `Selection` (from Task 17).
            -   Apply the transformation:
                -   `Move`: Adjust `Tile` positions or `Item` positions relative to the selection anchor. This might involve clearing old tiles and pasting/creating new ones at the destination.
                -   `Rotate/Flip`: For each `Tile` in the selection, transform its internal `Item` list (or relative item positions within the tile) and potentially specific item properties (e.g., a directional wall item's sprite or type might change). This is complex and relies on `ItemType`s supporting transformation or having different IDs for orientations. `Task69.md` must detail how items themselves (especially directional ones like walls, tables, carpets) are affected by rotate/flip.
            -   Update the `Map` data model.
            -   Clear and update the `Selection` object to reflect the new position/state of the transformed elements.
        -   **`undo()`:** Revert the transformation, restoring the `Tile`s/`Item`s to their state before the command.
    - **Triggering Commands:**
        -   `QAction`s in `MainWindow` menus/toolbars (created as stubs in Task 69's original description) for Move/Rotate/Flip should now instantiate the appropriate command object and push it onto the `QUndoStack`.
    - **Visual Updates:** `Map` modifications made by these commands must emit signals that cause `MapView`/`MapScene` to refresh the affected areas and the selection visuals.
    - **Interaction with Automagic Systems (`borderize`):**
        -   After a transformation (especially move or paste-like operations which `MoveSelectionCommand` might involve if it cuts-and-pastes), if `Automagic` bordering (Task 18/52/98) is enabled, the affected area (both old and new locations for a move) might need `borderize` called on it, or relevant `Map` methods that re-evaluate borders. This needs to happen *after* the primary items are in place.
        -   Consider if original `PasteTile` or selection transformations handled this re-borderization automatically.
    - **Complexity of Item Transformation:** Rotating/flipping `Item`s can be highly dependent on whether the `ItemType` itself has different variants for different orientations or if items have an "orientation" property. `TileLocation` properties on items might need updating.
    - **`Task69.md` is absolutely critical here. It needs to detail: how selections were moved (cut & paste vs. in-place); how rotation/flipping affected individual item types (e.g., did item IDs change, did sprite orientation change, what happened to multi-tile items); and if/how border updates were triggered after transformations.**
