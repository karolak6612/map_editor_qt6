**Task86: Migrate and Refactor the `Town` and `House` System (Enhanced - Full UI Editors, All Menu Actions, Tile Property Logic)**
- Task: **Enhance and fully migrate the Town and House management system. This includes complete migration of all related logic from `wxwidgets` concerning houses and towns: all menu actions, specialized tools (house/town editors), waypoint placement within houses/towns if applicable, and ensuring `Tile` properties correctly reflect house/town status. Implement full UI for editing and handle complex `Map->Tile` manipulations related to houses/towns being loaded, created, or modified.**
    - **Analyze Existing House/Town System:** Build upon `House`/`Town` data models, XML I/O (Task 66), and initial map interactions (Task 73) in `Project_QT/src`.
    - **Full UI Editors:**
        -   **`HouseEditorDialog/Panel`:** Implement a comprehensive UI for creating new houses and editing all properties of existing houses (name, owner, rent, size, entry point, tile list, guildhall status, etc.). This likely involves a list of all houses in the map, and a detailed property editor for the selected house.
        -   **`TownEditorDialog/Panel`:** Similar UI for creating and editing `Town`s and all their properties (name, temple position, other attributes).
    - **Menu Actions & Tools:**
        -   Migrate all `wxwidgets` menu items and toolbar buttons related to houses and towns (e.g., "Edit Houses," "Edit Towns," "Add New House," "Go to House/Town"). Connect these to open the new Qt editor dialogs/panels or trigger relevant actions.
        -   If waypoint placement tools had special behavior within houses or towns, ensure this logic is ported.
    - **`QGraphicsItem` Properties for Highlighting/Context:** When a house or town is selected in an editor UI, `MapView` should visually highlight the corresponding tiles or area using `QGraphicsItem` properties or overlays. Right-clicking a house tile on the map should offer relevant context menu actions (e.g., "Edit House Properties").
    - **Complex `Map->Tiles` Manipulation & Synchronization:**
        -   When houses/towns are loaded from XML/OTBM, ensure all associated `Tile`s are correctly marked (`Tile::setHouseID()`, `Tile::setTownID()`, flags like `isHouseTile`).
        -   When a house's tile list is modified (e.g., expanding a house), the `Map` must add/remove tiles from the `House` object and update the `HouseID` on those `Tile`s. This must be undoable.
        -   Logic for cleaning up `House` data on `Tile`s when a house is deleted (`Houses` structure in `map->tiles` or `Item`-based `TilesetHouse` concepts from `wxwidgets`).
    - **Integration with `ItemProperties` / `HouseTile`:**
        -   Clarify if house status on a `Tile` is via a direct `Tile::m_houseID` or via specific "House Marker" `Item`s with properties. `Task86.md` and `ItemProperties` on `TilesetHouse` will define this. The system must consistently use one approach.
        -   If `house->setExit` modified the map directly without explicit `Tile` events in `wxwidgets`, ensure that setting house exits now correctly updates `Tile` properties and triggers necessary signals.
    - **Actions like `HouseExitChange`:** Ensure these update all relevant data (House object, Tile property, possibly an Item attribute) and visuals, and are undoable.
    - **Scope:** This is a major integration task, aiming for full functionality of the house and town editing subsystems. Focus on the editor logic, UI, and data flow, rather than making dedicated new menu items if the current `master_prompt.txt` suggests these editors are panels under a `PropertyEditorDock` or contextually on `MapView` selection.
    - **`Task86.md` must provide the full original design of house/town editors, all menu actions, how `Map` and `Tile` data was manipulated (especially `HouseTile` interactions or complex `map->houses` structure from `wxwidgets`), and any specific handling for `buildListBox` or house exit modifications.**
